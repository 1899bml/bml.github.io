<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Lista de Sócios</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 2em; }
    h1 { text-align: center; margin-bottom: 1em; }
    .filters { text-align: center; margin-bottom: 2em; }
    .filters button { background: #ddd; border: none; padding: 0.5em 1em; margin: 0 0.3em; border-radius: 4px; cursor: pointer; }
    .filters .active { background: #0078d4; color: white; }
    .socio-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1em; }
    .socio-card { background: white; padding: 1em; border-radius: 6px; box-shadow: 0 0 5px rgba(0,0,0,0.05); }
    .back-link { display: block; text-align: center; margin-top: 2em; text-decoration: none; color: #0078d4; font-weight: bold; }
  </style>
</head>
<body>

  <h1>Lista de Sócios</h1>

  <div class="filters">
    <button class="active" onclick="filtrar('Todos')">Todos</button>
    <button onclick="filtrar('Ativo')">Ativo</button>
    <button onclick="filtrar('Inativo')">Inativo</button>
    <button onclick="filtrar('Pendente')">Pendente</button>
  </div>

  <div class="socio-list" id="lista"></div>

  <a class="back-link" href="index.html">← Voltar ao painel</a>

  <script>
    const sheetID = '1v5Zf8fxY-cIq8xw0G8hoeHDRUAXzpDmGEj16qf4_LhQ';
    const apiKey = 'AIzaSyBbb8_6fOmFweuLmla-mQz3MolkQqLPk1w';
    const range = 'Folha1!A2:F';
    let todos = [];

    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${range}?key=${apiKey}`)
      .then(res => res.json())
      .then(data => {
        todos = data.values || [];
        mostrar(todos);
      })
      .catch(err => {
        document.getElementById("lista").innerHTML = "<p>Erro ao carregar dados.</p>";
        console.error(err);
      });

    function mostrar(lista) {
      const container = document.getElementById("lista");
      container.innerHTML = "";
      lista.forEach(linha => {
        const [nome, email, telefone, categoria, data, endereco] = linha;
        const card = document.createElement("div");
        card.className = "socio-card";
        card.innerHTML = `
          <strong>${nome}</strong><br>
          ${email ? `📧 ${email}<br>` : ""}
          ${telefone ? `📞 ${telefone}<br>` : ""}
          ${categoria ? `📌 ${categoria}<br>` : ""}
          ${data ? `📅 ${data}<br>` : ""}
          ${endereco ? `🏠 ${endereco}` : ""}
        `;
        container.appendChild(card);
      });
    }

    function filtrar(categoria) {
      document.querySelectorAll(".filters button").forEach(btn => btn.classList.remove("active"));
      document.querySelector(`.filters button[onclick="filtrar('${categoria}')"]`).classList.add("active");

      if (categoria === "Todos") {
        mostrar(todos);
      } else {
        const filtrados = todos.filter(linha => linha[3] === categoria);
        mostrar(filtrados);
      }
    }
  </script>

</body>
</html>
